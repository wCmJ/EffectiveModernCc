## CPU上下文切换
- 切换的内容：寄存器，PC
- 切换类型
  - 进程切换
    - 用户空间：虚拟内存、栈、全局变量
    - 内核空间：寄存器、PC
  - 线程切换
    - 同一进程中线程切换：线程共享虚拟内存和全局变量，只需要切换线程栈及内核空间
    - 不同进程间的线程切换：与进程切换一致
  - 中断切换
    - 不改变用户空间内容，只切换内核空间
  - 系统调用切换
    - 只切换内核空间
- 切换监控
  - vmstat：监控系统级别的上下文切换及中断情况
  - pidstat：监控进程及线程的上下文切换及中断情况
  - /proc/interrupts：查看中断类型

## CPU使用率
- 不处于IDLE状态的时间占比
- /proc/stat及/proc/[pid]/stat：

- 查看CPU使用率
  - top：显示系统总体的情况，默认使用3s的时间间隔
  - ps：显示各个进程的资源使用情况，进程整个生命周期
  - pidstat：进程详细情况，包括用户态CPU使用率、内核态CPU使用率、等待CPU使用率、运行虚拟机CPU使用率、总的CPU使用率

- 排查CPU使用率过高问题
  - 使用top、ps、pidstat找出CPU使用率较高的进程
  - 找出具体的函数
    - GDB：GDB调试程序的过程会中断程序的运行，只适合在性能分析的后期，线下借助GDB来进一步调试函数内部的问题
    - perf：Linux内置的性能分析工具，以性能采样事件为基础，不仅可以分析系统的各种事件和内核性能，还可以用来分析指定应用程序的性能问题
      - perf top
      - perf record









